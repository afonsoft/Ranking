!function(e){e(function(){e("#UserProfileBackToMyAccountButton").click(function(e){e.preventDefault(),abp.ajax({url:abp.appPath+"Account/BackToImpersonator",success:function(){app.supportsTenancyNameInUrl||abp.multiTenancy.setTenantIdCookie(abp.session.impersonatorTenantId)}})});var a=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/MySettingsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_MySettingsModal.js",modalClass:"MySettingsModal"});e("#UserProfileMySettingsLink").click(function(e){e.preventDefault(),a.open()}),e("#UserDownloadCollectedDataLink").click(function(e){e.preventDefault(),abp.services.app.profile.prepareCollectedData().done(function(){abp.message.success(app.localize("GdprDataPrepareStartedNotification"))})});var t=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/ChangePasswordModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_ChangePasswordModal.js",modalClass:"ChangePasswordModal"});e("#UserProfileChangePasswordLink").click(function(e){e.preventDefault(),t.open()});var n=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/ChangePictureModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_ChangePictureModal.js",modalClass:"ChangeProfilePictureModal"});e("#UserProfileChangePictureLink").click(function(e){e.preventDefault(),n.open()});var i=new app.ModalManager({viewUrl:abp.appPath+"App/Users/LoginAttemptsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Users/_LoginAttemptsModal.js",modalClass:"LoginAttemptsModal"});e("#ShowLoginAttemptsLink").click(function(e){e.preventDefault(),i.open()});var o=abp.services.app.userLink,s=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/LinkedAccountsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_LinkedAccountsModal.js",modalClass:"LinkedAccountsModal"}),r=function(){o.getRecentlyUsedLinkedUsers().done(function(a){!function(a){var t=e("ul#RecentlyUsedLinkedUsers");e.each(a.items,function(e,a){a.shownUserName=app.getShownLinkedUserName(a)}),a.hasLinkedUsers=function(){return this.items.length>0};var n=e("#linkedAccountsSubMenuTemplate").html();Mustache.parse(n);var i=Mustache.render(n,a);t.html(i),a&&a.items&&a.items.length||e("#RecentlyUsedLinkedUsers").closest("div").hide()}(a),e("#ManageLinkedAccountsLink").click(function(e){e.preventDefault(),s.open()}),e(".recently-linked-user").click(function(a){a.preventDefault();var t,n,i=e(this).attr("data-user-id"),o=e(this).attr("data-tenant-id");i&&(t=i,n=o,abp.ajax({url:abp.appPath+"Account/SwitchToLinkedAccount",data:JSON.stringify({targetUserId:t,targetTenantId:n}),success:function(){app.supportsTenancyNameInUrl||abp.multiTenancy.setTenantIdCookie(n)}}))})})};s.onClose(function(){r()});var p=new app.UserNotificationHelper,c=abp.services.app.notification;function l(){c.getUserNotifications({maxResultCount:3}).done(function(a){a.notifications=[],a.unreadMessageExists=a.unreadCount>0,e.each(a.items,function(e,t){var n=p.format(t);a.notifications.push(n)});var t=e("#header_notification_bar"),n=e("#headerNotificationBarTemplate").html();Mustache.parse(n);var i=Mustache.render(n,a);t.html(i),e("#setAllNotificationsAsReadLink").click(function(e){e.preventDefault(),e.stopPropagation(),p.setAllAsRead(function(){l()})}),e(".set-notification-as-read").click(function(a){a.preventDefault(),a.stopPropagation();var t=e(this).attr("data-notification-id");t&&p.setAsRead(t,function(){l()})}),e("#openNotificationSettingsModalLink").click(function(e){e.preventDefault(),e.stopPropagation(),p.openSettingsModal()}),e("a.user-notification-item-clickable").click(function(){var a=e(this).attr("data-url");document.location.href=a})})}abp.event.on("abp.notifications.received",function(e){p.show(e),l()}),abp.event.on("app.notifications.refresh",function(){l()}),abp.event.on("app.notifications.read",function(e){l()}),abp.event.on("app.chat.unreadMessageCountChanged",function(a){e("#chatIconUnRead .unread-chat-message-count").text(a),a?(e("#chatIconUnRead").removeClass("d-none"),e("#chatIcon").addClass("d-none")):(e("#chatIconUnRead").addClass("d-none"),e("#chatIcon").removeClass("d-none"))});var u=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/UserDelegationsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_UserDelegationsModal.js",modalClass:"UserDelegationsModal"});e("#ManageUserDelegations").click(function(e){e.preventDefault(),u.open()}),e("#ActiveUserDelegationsCombobox").click(function(){var a=e(this),t=parseInt(a.val());if(!(t<=0)&&t){var n=a.children("option:selected").attr("data-username");abp.message.confirm(app.localize("SwitchToDelegatedUserWarningMessage",n),app.localize("AreYouSure"),function(e){if(!e)return a.val(a.attr("data-value")),!1;a.attr("data-value",t),abp.ajax({url:abp.appPath+"Account/DelegatedImpersonate",data:JSON.stringify({userDelegationId:t})})})}}),e("#kt_quick_user_toggle").click(function(){e("#kt_quick_sidebar").hasClass("offcanvas-on")&&abp.event.trigger("app.show.quickUserPanel")}),l(),r()})}(jQuery);