!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.signalR=e():t.signalR=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);n(1);var r=n(3);n.d(e,"VERSION",function(){return r.VERSION}),n.d(e,"AbortError",function(){return r.AbortError}),n.d(e,"HttpError",function(){return r.HttpError}),n.d(e,"TimeoutError",function(){return r.TimeoutError}),n.d(e,"HttpClient",function(){return r.HttpClient}),n.d(e,"HttpResponse",function(){return r.HttpResponse}),n.d(e,"DefaultHttpClient",function(){return r.DefaultHttpClient}),n.d(e,"HubConnection",function(){return r.HubConnection}),n.d(e,"HubConnectionState",function(){return r.HubConnectionState}),n.d(e,"HubConnectionBuilder",function(){return r.HubConnectionBuilder}),n.d(e,"MessageType",function(){return r.MessageType}),n.d(e,"LogLevel",function(){return r.LogLevel}),n.d(e,"HttpTransportType",function(){return r.HttpTransportType}),n.d(e,"TransferFormat",function(){return r.TransferFormat}),n.d(e,"NullLogger",function(){return r.NullLogger}),n.d(e,"JsonHubProtocol",function(){return r.JsonHubProtocol}),n.d(e,"Subject",function(){return r.Subject}),Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,"indexOf",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:function(t,e){return new Uint8Array(Array.prototype.slice.call(this,t,e))},writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach,writable:!0})},function(t,e,n){(function(e){var r;r=function(){"use strict";function t(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,s=void 0,c=function(t,e){g[o]=t,g[o+1]=e,2===(o+=2)&&(s?s(d):w())},a="undefined"!=typeof window?window:void 0,u=a||{},l=u.MutationObserver||u.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(d,1)}}var g=new Array(1e3);function d(){for(var t=0;t<o;t+=2){(0,g[t])(g[t+1]),g[t]=void 0,g[t+1]=void 0}o=0}var v,y,b,m,w=void 0;function S(t,e){var n=this,r=new this.constructor(T);void 0===r[C]&&U(r);var o=n._state;if(o){var i=arguments[o-1];c(function(){return N(o,r,i,n._result)})}else R(n,r,t,e);return r}function L(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(T);return _(e,t),e}h?w=function(){return process.nextTick(d)}:l?(y=0,b=new l(d),m=document.createTextNode(""),b.observe(m,{characterData:!0}),w=function(){m.data=y=++y%2}):p?((v=new MessageChannel).port1.onmessage=d,w=function(){return v.port2.postMessage(0)}):w=void 0===a?function(){try{var t=n(!function(){var t=new Error("Cannot find module 'vertx'");throw t.code="MODULE_NOT_FOUND",t}());return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(d)}:f()}catch(t){return f()}}():f();var C=Math.random().toString(36).substring(16);function T(){}var E=void 0,k=1,P=2,I=new O;function H(t){try{return t.then}catch(t){return I.error=t,I}}function D(e,n,r){n.constructor===e.constructor&&r===S&&n.constructor.resolve===L?function(t,e){e._state===k?j(t,e._result):e._state===P?x(t,e._result):R(e,void 0,function(e){return _(t,e)},function(e){return x(t,e)})}(e,n):r===I?(x(e,I.error),I.error=null):void 0===r?j(e,n):t(r)?function(t,e,n){c(function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,function(n){r||(r=!0,e!==n?_(t,n):j(t,n))},function(e){r||(r=!0,x(t,e))},t._label);!r&&o&&(r=!0,x(t,o))},t)}(e,n,r):j(e,n)}function _(t,e){var n,r;t===e?x(t,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=e),null===n||"object"!==r&&"function"!==r?j(t,e):D(t,e,H(e)))}function A(t){t._onerror&&t._onerror(t._result),M(t)}function j(t,e){t._state===E&&(t._result=e,t._state=k,0!==t._subscribers.length&&c(M,t))}function x(t,e){t._state===E&&(t._state=P,t._result=e,c(A,t))}function R(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+k]=n,o[i+P]=r,0===i&&t._state&&c(M,t)}function M(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?N(n,r,o,i):o(i);t._subscribers.length=0}}function O(){this.error=null}var F=new O;function N(e,n,r,o){var i=t(r),s=void 0,c=void 0,a=void 0,u=void 0;if(i){if((s=function(t,e){try{return t(e)}catch(t){return F.error=t,F}}(r,o))===F?(u=!0,c=s.error,s.error=null):a=!0,n===s)return void x(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,a=!0;n._state!==E||(i&&a?_(n,s):u?x(n,c):e===k?j(n,s):e===P&&x(n,s))}var W=0;function U(t){t[C]=W++,t._state=void 0,t._result=void 0,t._subscribers=[]}var q=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(T),this.promise[C]||U(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&j(this.promise,this._result))):x(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===E&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===L){var o=H(t);if(o===S&&t._state!==E)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===B){var i=new n(T);D(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===E&&(this._remaining--,t===P?x(r,n):this._result[e]=n),0===this._remaining&&j(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;R(t,void 0,function(t){return n._settledAt(k,e,t)},function(t){return n._settledAt(P,e,t)})},t}(),B=function(){function t(e){this[C]=W++,this._result=this._state=void 0,this._subscribers=[],T!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){try{e(function(e){_(t,e)},function(e){x(t,e)})}catch(e){x(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){throw n})})},t}();return B.prototype.then=S,B.all=function(t){return new q(this,t).promise},B.race=function(t){var e=this;return r(t)?new e(function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})},B.resolve=L,B.reject=function(t){var e=new this(T);return x(e,t),e},B._setScheduler=function(t){s=t},B._setAsap=function(t){c=t},B._asap=c,B.polyfill=function(){var t=void 0;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}t.Promise=B},B.Promise=B,B.polyfill(),B},t.exports=r()}).call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e),n.d(e,"VERSION",function(){return g});var r=n(4);n.d(e,"AbortError",function(){return r.AbortError}),n.d(e,"HttpError",function(){return r.HttpError}),n.d(e,"TimeoutError",function(){return r.TimeoutError});var o=n(5);n.d(e,"HttpClient",function(){return o.HttpClient}),n.d(e,"HttpResponse",function(){return o.HttpResponse});var i=n(6);n.d(e,"DefaultHttpClient",function(){return i.DefaultHttpClient});var s=n(10);n.d(e,"HubConnection",function(){return s.HubConnection}),n.d(e,"HubConnectionState",function(){return s.HubConnectionState});var c=n(17);n.d(e,"HubConnectionBuilder",function(){return c.HubConnectionBuilder});var a=n(15);n.d(e,"MessageType",function(){return a.MessageType});var u=n(9);n.d(e,"LogLevel",function(){return u.LogLevel});var l=n(20);n.d(e,"HttpTransportType",function(){return l.HttpTransportType}),n.d(e,"TransferFormat",function(){return l.TransferFormat});var h=n(14);n.d(e,"NullLogger",function(){return h.NullLogger});var p=n(25);n.d(e,"JsonHubProtocol",function(){return p.JsonHubProtocol});var f=n(16);n.d(e,"Subject",function(){return f.Subject});var g="3.1.2"},function(t,e,n){"use strict";n.r(e),n.d(e,"HttpError",function(){return i}),n.d(e,"TimeoutError",function(){return s}),n.d(e,"AbortError",function(){return c});var r,o=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function e(e,n){var r=this,o=this.constructor.prototype;return(r=t.call(this,e)||this).statusCode=n,r.__proto__=o,r}return o(e,t),e}(Error),s=function(t){function e(e){void 0===e&&(e="A timeout occurred.");var n=this,r=this.constructor.prototype;return(n=t.call(this,e)||this).__proto__=r,n}return o(e,t),e}(Error),c=function(t){function e(e){void 0===e&&(e="An abort occurred.");var n=this,r=this.constructor.prototype;return(n=t.call(this,e)||this).__proto__=r,n}return o(e,t),e}(Error)},function(t,e,n){"use strict";n.r(e),n.d(e,"HttpResponse",function(){return o}),n.d(e,"HttpClient",function(){return i});var r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=function(){return function(t,e,n){this.statusCode=t,this.statusText=e,this.content=n}}(),i=function(){function t(){}return t.prototype.get=function(t,e){return this.send(r({},e,{method:"GET",url:t}))},t.prototype.post=function(t,e){return this.send(r({},e,{method:"POST",url:t}))},t.prototype.delete=function(t,e){return this.send(r({},e,{method:"DELETE",url:t}))},t.prototype.getCookieString=function(t){return""},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"DefaultHttpClient",function(){return u});var r,o=n(4),i=n(5),s=n(7),c=n(8),a=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(e){var n=t.call(this)||this;return"undefined"!=typeof XMLHttpRequest?n.httpClient=new c.XhrHttpClient(e):n.httpClient=new s.NodeHttpClient(e),n}return a(e,t),e.prototype.send=function(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new o.AbortError):t.method?t.url?this.httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},e.prototype.getCookieString=function(t){return this.httpClient.getCookieString(t)},e}(i.HttpClient)},function(t,e,n){"use strict";n.r(e),n.d(e,"NodeHttpClient",function(){return s});var r,o=n(5),i=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){return t.call(this)||this}return i(e,t),e.prototype.send=function(){return Promise.reject(new Error("If using Node either provide an XmlHttpRequest polyfill or consume the cjs or esm script instead of the browser/signalr.js one."))},e}(o.HttpClient)},function(t,e,n){"use strict";n.r(e),n.d(e,"XhrHttpClient",function(){return a});var r,o=n(4),i=n(5),s=n(9),c=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.logger=e,n}return c(e,t),e.prototype.send=function(t){var e=this;return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new o.AbortError):t.method?t.url?new Promise(function(n,r){var c=new XMLHttpRequest;c.open(t.method,t.url,!0),c.withCredentials=!0,c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var a=t.headers;a&&Object.keys(a).forEach(function(t){c.setRequestHeader(t,a[t])}),t.responseType&&(c.responseType=t.responseType),t.abortSignal&&(t.abortSignal.onabort=function(){c.abort(),r(new o.AbortError)}),t.timeout&&(c.timeout=t.timeout),c.onload=function(){t.abortSignal&&(t.abortSignal.onabort=null),c.status>=200&&c.status<300?n(new i.HttpResponse(c.status,c.statusText,c.response||c.responseText)):r(new o.HttpError(c.statusText,c.status))},c.onerror=function(){e.logger.log(s.LogLevel.Warning,"Error from HTTP request. "+c.status+": "+c.statusText+"."),r(new o.HttpError(c.statusText,c.status))},c.ontimeout=function(){e.logger.log(s.LogLevel.Warning,"Timeout from HTTP request."),r(new o.TimeoutError)},c.send(t.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},e}(i.HttpClient)},function(t,e,n){"use strict";var r;n.r(e),n.d(e,"LogLevel",function(){return r}),function(t){t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Information=2]="Information",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Critical=5]="Critical",t[t.None=6]="None"}(r||(r={}))},function(t,e,n){"use strict";n.r(e),n.d(e,"HubConnectionState",function(){return r}),n.d(e,"HubConnection",function(){return f});var r,o=n(11),i=n(15),s=n(9),c=n(16),a=n(13),u=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,c)}a((r=r.apply(t,e||[])).next())})},l=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},h=3e4,p=15e3;!function(t){t.Disconnected="Disconnected",t.Connecting="Connecting",t.Connected="Connected",t.Disconnecting="Disconnecting",t.Reconnecting="Reconnecting"}(r||(r={}));var f=function(){function t(t,e,n,s){var c=this;a.Arg.isRequired(t,"connection"),a.Arg.isRequired(e,"logger"),a.Arg.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=h,this.keepAliveIntervalInMilliseconds=p,this.logger=e,this.protocol=n,this.connection=t,this.reconnectPolicy=s,this.handshakeProtocol=new o.HandshakeProtocol,this.connection.onreceive=function(t){return c.processIncomingData(t)},this.connection.onclose=function(t){return c.connectionClosed(t)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.reconnectingCallbacks=[],this.reconnectedCallbacks=[],this.invocationId=0,this.receivedHandshakeResponse=!1,this.connectionState=r.Disconnected,this.connectionStarted=!1,this.cachedPingMessage=this.protocol.writeMessage({type:i.MessageType.Ping})}return t.create=function(e,n,r,o){return new t(e,n,r,o)},Object.defineProperty(t.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connectionId",{get:function(){return this.connection&&this.connection.connectionId||null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseUrl",{get:function(){return this.connection.baseUrl||""},set:function(t){if(this.connectionState!==r.Disconnected&&this.connectionState!==r.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t},enumerable:!0,configurable:!0}),t.prototype.start=function(){return this.startPromise=this.startWithStateTransitions(),this.startPromise},t.prototype.startWithStateTransitions=function(){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:if(this.connectionState!==r.Disconnected)return[2,Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."))];this.connectionState=r.Connecting,this.logger.log(s.LogLevel.Debug,"Starting HubConnection."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.startInternal()];case 2:return e.sent(),this.connectionState=r.Connected,this.connectionStarted=!0,this.logger.log(s.LogLevel.Debug,"HubConnection connected successfully."),[3,4];case 3:return t=e.sent(),this.connectionState=r.Disconnected,this.logger.log(s.LogLevel.Debug,"HubConnection failed to start successfully because of error '"+t+"'."),[2,Promise.reject(t)];case 4:return[2]}})})},t.prototype.startInternal=function(){return u(this,void 0,void 0,function(){var t,e,n,r=this;return l(this,function(o){switch(o.label){case 0:return this.stopDuringStartError=void 0,this.receivedHandshakeResponse=!1,t=new Promise(function(t,e){r.handshakeResolver=t,r.handshakeRejecter=e}),[4,this.connection.start(this.protocol.transferFormat)];case 1:o.sent(),o.label=2;case 2:return o.trys.push([2,5,,7]),e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(s.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 3:return o.sent(),this.logger.log(s.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 4:if(o.sent(),this.stopDuringStartError)throw this.stopDuringStartError;return[3,7];case 5:return n=o.sent(),this.logger.log(s.LogLevel.Debug,"Hub handshake failed with error '"+n+"' during start(). Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),[4,this.connection.stop(n)];case 6:throw o.sent(),n;case 7:return[2]}})})},t.prototype.stop=function(){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return t=this.startPromise,this.stopPromise=this.stopInternal(),[4,this.stopPromise];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t];case 3:return e.sent(),[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})})},t.prototype.stopInternal=function(t){return this.connectionState===r.Disconnected?(this.logger.log(s.LogLevel.Debug,"Call to HubConnection.stop("+t+") ignored because it is already in the disconnected state."),Promise.resolve()):this.connectionState===r.Disconnecting?(this.logger.log(s.LogLevel.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnecting state."),this.stopPromise):(this.connectionState=r.Disconnecting,this.logger.log(s.LogLevel.Debug,"Stopping HubConnection."),this.reconnectDelayHandle?(this.logger.log(s.LogLevel.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.reconnectDelayHandle),this.reconnectDelayHandle=void 0,this.completeClose(),Promise.resolve()):(this.cleanupTimeout(),this.cleanupPingTimer(),this.stopDuringStartError=t||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(t)))},t.prototype.stream=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o,s=this.replaceStreamingParams(n),a=s[0],u=s[1],l=this.createStreamInvocation(t,n,u),h=new c.Subject;return h.cancelCallback=function(){var t=e.createCancelInvocation(l.invocationId);return delete e.callbacks[l.invocationId],o.then(function(){return e.sendWithProtocol(t)})},this.callbacks[l.invocationId]=function(t,e){e?h.error(e):t&&(t.type===i.MessageType.Completion?t.error?h.error(new Error(t.error)):h.complete():h.next(t.item))},o=this.sendWithProtocol(l).catch(function(t){h.error(t),delete e.callbacks[l.invocationId]}),this.launchStreams(a,o),h},t.prototype.sendMessage=function(t){return this.resetKeepAliveInterval(),this.connection.send(t)},t.prototype.sendWithProtocol=function(t){return this.sendMessage(this.protocol.writeMessage(t))},t.prototype.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.replaceStreamingParams(e),o=r[0],i=r[1],s=this.sendWithProtocol(this.createInvocation(t,e,!0,i));return this.launchStreams(o,s),s},t.prototype.invoke=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.replaceStreamingParams(n),s=o[0],c=o[1],a=this.createInvocation(t,n,!1,c);return new Promise(function(t,n){e.callbacks[a.invocationId]=function(e,r){r?n(r):e&&(e.type===i.MessageType.Completion?e.error?n(new Error(e.error)):t(e.result):n(new Error("Unexpected message type: "+e.type)))};var r=e.sendWithProtocol(a).catch(function(t){n(t),delete e.callbacks[a.invocationId]});e.launchStreams(s,r)})},t.prototype.on=function(t,e){t&&e&&(t=t.toLowerCase(),this.methods[t]||(this.methods[t]=[]),-1===this.methods[t].indexOf(e)&&this.methods[t].push(e))},t.prototype.off=function(t,e){if(t){t=t.toLowerCase();var n=this.methods[t];if(n)if(e){var r=n.indexOf(e);-1!==r&&(n.splice(r,1),0===n.length&&delete this.methods[t])}else delete this.methods[t]}},t.prototype.onclose=function(t){t&&this.closedCallbacks.push(t)},t.prototype.onreconnecting=function(t){t&&this.reconnectingCallbacks.push(t)},t.prototype.onreconnected=function(t){t&&this.reconnectedCallbacks.push(t)},t.prototype.processIncomingData=function(t){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(t=this.processHandshakeResponse(t),this.receivedHandshakeResponse=!0),t)for(var e=0,n=this.protocol.parseMessages(t,this.logger);e<n.length;e++){var r=n[e];switch(r.type){case i.MessageType.Invocation:this.invokeClientMethod(r);break;case i.MessageType.StreamItem:case i.MessageType.Completion:var o=this.callbacks[r.invocationId];o&&(r.type===i.MessageType.Completion&&delete this.callbacks[r.invocationId],o(r));break;case i.MessageType.Ping:break;case i.MessageType.Close:this.logger.log(s.LogLevel.Information,"Close message received from server.");var c=r.error?new Error("Server returned an error on close: "+r.error):void 0;!0===r.allowReconnect?this.connection.stop(c):this.stopPromise=this.stopInternal(c);break;default:this.logger.log(s.LogLevel.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},t.prototype.processHandshakeResponse=function(t){var e,n,r;try{r=(e=this.handshakeProtocol.parseHandshakeResponse(t))[0],n=e[1]}catch(t){var o="Error parsing handshake response: "+t;this.logger.log(s.LogLevel.Error,o);var i=new Error(o);throw this.handshakeRejecter(i),i}if(n.error){o="Server returned handshake error: "+n.error;this.logger.log(s.LogLevel.Error,o);i=new Error(o);throw this.handshakeRejecter(i),i}return this.logger.log(s.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),r},t.prototype.resetKeepAliveInterval=function(){var t=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout(function(){return u(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:if(this.connectionState!==r.Connected)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return t.sent(),[3,4];case 3:return t.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},this.keepAliveIntervalInMilliseconds)},t.prototype.resetTimeoutPeriod=function(){var t=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return t.serverTimeout()},this.serverTimeoutInMilliseconds))},t.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},t.prototype.invokeClientMethod=function(t){var e=this,n=this.methods[t.target.toLowerCase()];if(n){try{n.forEach(function(n){return n.apply(e,t.arguments)})}catch(e){this.logger.log(s.LogLevel.Error,"A callback for the method "+t.target.toLowerCase()+" threw error '"+e+"'.")}if(t.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this.logger.log(s.LogLevel.Error,r),this.stopPromise=this.stopInternal(new Error(r))}}else this.logger.log(s.LogLevel.Warning,"No client method with the name '"+t.target+"' found.")},t.prototype.connectionClosed=function(t){this.logger.log(s.LogLevel.Debug,"HubConnection.connectionClosed("+t+") called while in state "+this.connectionState+"."),this.stopDuringStartError=this.stopDuringStartError||t||new Error("The underlying connection was closed before the hub handshake could complete."),this.handshakeResolver&&this.handshakeResolver(),this.cancelCallbacksWithError(t||new Error("Invocation canceled due to the underlying connection being closed.")),this.cleanupTimeout(),this.cleanupPingTimer(),this.connectionState===r.Disconnecting?this.completeClose(t):this.connectionState===r.Connected&&this.reconnectPolicy?this.reconnect(t):this.connectionState===r.Connected&&this.completeClose(t)},t.prototype.completeClose=function(t){var e=this;if(this.connectionStarted){this.connectionState=r.Disconnected,this.connectionStarted=!1;try{this.closedCallbacks.forEach(function(n){return n.apply(e,[t])})}catch(e){this.logger.log(s.LogLevel.Error,"An onclose callback called with error '"+t+"' threw error '"+e+"'.")}}},t.prototype.reconnect=function(t){return u(this,void 0,void 0,function(){var e,n,o,i,c,a=this;return l(this,function(u){switch(u.label){case 0:if(e=Date.now(),n=0,o=void 0!==t?t:new Error("Attempting to reconnect due to a unknown error."),null===(i=this.getNextRetryDelay(n++,0,o)))return this.logger.log(s.LogLevel.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this.completeClose(t),[2];if(this.connectionState=r.Reconnecting,t?this.logger.log(s.LogLevel.Information,"Connection reconnecting because of error '"+t+"'."):this.logger.log(s.LogLevel.Information,"Connection reconnecting."),this.onreconnecting){try{this.reconnectingCallbacks.forEach(function(e){return e.apply(a,[t])})}catch(e){this.logger.log(s.LogLevel.Error,"An onreconnecting callback called with error '"+t+"' threw error '"+e+"'.")}if(this.connectionState!==r.Reconnecting)return this.logger.log(s.LogLevel.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),[2]}u.label=1;case 1:return null===i?[3,7]:(this.logger.log(s.LogLevel.Information,"Reconnect attempt number "+n+" will start in "+i+" ms."),[4,new Promise(function(t){a.reconnectDelayHandle=setTimeout(t,i)})]);case 2:if(u.sent(),this.reconnectDelayHandle=void 0,this.connectionState!==r.Reconnecting)return this.logger.log(s.LogLevel.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),[2];u.label=3;case 3:return u.trys.push([3,5,,6]),[4,this.startInternal()];case 4:if(u.sent(),this.connectionState=r.Connected,this.logger.log(s.LogLevel.Information,"HubConnection reconnected successfully."),this.onreconnected)try{this.reconnectedCallbacks.forEach(function(t){return t.apply(a,[a.connection.connectionId])})}catch(t){this.logger.log(s.LogLevel.Error,"An onreconnected callback called with connectionId '"+this.connection.connectionId+"; threw error '"+t+"'.")}return[2];case 5:return c=u.sent(),this.logger.log(s.LogLevel.Information,"Reconnect attempt failed because of error '"+c+"'."),this.connectionState!==r.Reconnecting?(this.logger.log(s.LogLevel.Debug,"Connection left the reconnecting state during reconnect attempt. Done reconnecting."),[2]):(o=c instanceof Error?c:new Error(c.toString()),i=this.getNextRetryDelay(n++,Date.now()-e,o),[3,6]);case 6:return[3,1];case 7:return this.logger.log(s.LogLevel.Information,"Reconnect retries have been exhausted after "+(Date.now()-e)+" ms and "+n+" failed attempts. Connection disconnecting."),this.completeClose(),[2]}})})},t.prototype.getNextRetryDelay=function(t,e,n){try{return this.reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:e,previousRetryCount:t,retryReason:n})}catch(n){return this.logger.log(s.LogLevel.Error,"IRetryPolicy.nextRetryDelayInMilliseconds("+t+", "+e+") threw error '"+n+"'."),null}},t.prototype.cancelCallbacksWithError=function(t){var e=this.callbacks;this.callbacks={},Object.keys(e).forEach(function(n){(0,e[n])(null,t)})},t.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},t.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},t.prototype.createInvocation=function(t,e,n,r){if(n)return{arguments:e,streamIds:r,target:t,type:i.MessageType.Invocation};var o=this.invocationId;return this.invocationId++,{arguments:e,invocationId:o.toString(),streamIds:r,target:t,type:i.MessageType.Invocation}},t.prototype.launchStreams=function(t,e){var n=this;if(0!==t.length){e||(e=Promise.resolve());var r=function(r){t[r].subscribe({complete:function(){e=e.then(function(){return n.sendWithProtocol(n.createCompletionMessage(r))})},error:function(t){var o;o=t instanceof Error?t.message:t&&t.toString?t.toString():"Unknown error",e=e.then(function(){return n.sendWithProtocol(n.createCompletionMessage(r,o))})},next:function(t){e=e.then(function(){return n.sendWithProtocol(n.createStreamItemMessage(r,t))})}})};for(var o in t)r(o)}},t.prototype.replaceStreamingParams=function(t){for(var e=[],n=[],r=0;r<t.length;r++){var o=t[r];if(this.isObservable(o)){var i=this.invocationId;this.invocationId++,e[i]=o,n.push(i.toString()),t.splice(r,1)}}return[e,n]},t.prototype.isObservable=function(t){return t&&t.subscribe&&"function"==typeof t.subscribe},t.prototype.createStreamInvocation=function(t,e,n){var r=this.invocationId;return this.invocationId++,{arguments:e,invocationId:r.toString(),streamIds:n,target:t,type:i.MessageType.StreamInvocation}},t.prototype.createCancelInvocation=function(t){return{invocationId:t,type:i.MessageType.CancelInvocation}},t.prototype.createStreamItemMessage=function(t,e){return{invocationId:t,item:e,type:i.MessageType.StreamItem}},t.prototype.createCompletionMessage=function(t,e,n){return e?{error:e,invocationId:t,type:i.MessageType.Completion}:{invocationId:t,result:n,type:i.MessageType.Completion}},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"HandshakeProtocol",function(){return i});var r=n(12),o=n(13),i=function(){function t(){}return t.prototype.writeHandshakeRequest=function(t){return r.TextMessageFormat.write(JSON.stringify(t))},t.prototype.parseHandshakeResponse=function(t){var e,n;if(Object(o.isArrayBuffer)(t)||"undefined"!=typeof Buffer&&t instanceof Buffer){var i=new Uint8Array(t);if(-1===(c=i.indexOf(r.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var s=c+1;e=String.fromCharCode.apply(null,i.slice(0,s)),n=i.byteLength>s?i.slice(s).buffer:null}else{var c,a=t;if(-1===(c=a.indexOf(r.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");s=c+1;e=a.substring(0,s),n=a.length>s?a.substring(s):null}var u=r.TextMessageFormat.parse(e),l=JSON.parse(u[0]);if(l.type)throw new Error("Expected a handshake response from the server.");return[n,l]},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"TextMessageFormat",function(){return r});var r=function(){function t(){}return t.write=function(e){return""+e+t.RecordSeparator},t.parse=function(e){if(e[e.length-1]!==t.RecordSeparator)throw new Error("Message is incomplete.");var n=e.split(t.RecordSeparator);return n.pop(),n},t.RecordSeparatorCode=30,t.RecordSeparator=String.fromCharCode(t.RecordSeparatorCode),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"Arg",function(){return c}),n.d(e,"Platform",function(){return a}),n.d(e,"getDataDetail",function(){return u}),n.d(e,"formatArrayBuffer",function(){return l}),n.d(e,"isArrayBuffer",function(){return h}),n.d(e,"sendMessage",function(){return p}),n.d(e,"createLogger",function(){return f}),n.d(e,"SubjectSubscription",function(){return g}),n.d(e,"ConsoleLogger",function(){return d});var r=n(9),o=n(14),i=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,c)}a((r=r.apply(t,e||[])).next())})},s=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},c=function(){function t(){}return t.isRequired=function(t,e){if(null==t)throw new Error("The '"+e+"' argument is required.")},t.isIn=function(t,e,n){if(!(t in e))throw new Error("Unknown "+n+" value: "+t+".")},t}(),a=function(){function t(){}return Object.defineProperty(t,"isBrowser",{get:function(){return"object"==typeof window},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWebWorker",{get:function(){return"object"==typeof self&&"importScripts"in self},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isNode",{get:function(){return!this.isBrowser&&!this.isWebWorker},enumerable:!0,configurable:!0}),t}();function u(t,e){var n="";return h(t)?(n="Binary data of length "+t.byteLength,e&&(n+=". Content: '"+l(t)+"'")):"string"==typeof t&&(n="String data of length "+t.length,e&&(n+=". Content: '"+t+"'")),n}function l(t){var e=new Uint8Array(t),n="";return e.forEach(function(t){n+="0x"+(t<16?"0":"")+t.toString(16)+" "}),n.substr(0,n.length-1)}function h(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function p(t,e,n,o,c,a,l){return i(this,void 0,void 0,function(){var i,p,f,g,d;return s(this,function(s){switch(s.label){case 0:return c?[4,c()]:[3,2];case 1:(f=s.sent())&&((i={}).Authorization="Bearer "+f,p=i),s.label=2;case 2:return t.log(r.LogLevel.Trace,"("+e+" transport) sending data. "+u(a,l)+"."),g=h(a)?"arraybuffer":"text",[4,n.post(o,{content:a,headers:p,responseType:g})];case 3:return d=s.sent(),t.log(r.LogLevel.Trace,"("+e+" transport) request complete. Response status: "+d.statusCode+"."),[2]}})})}function f(t){return void 0===t?new d(r.LogLevel.Information):null===t?o.NullLogger.instance:t.log?t:new d(t)}var g=function(){function t(t,e){this.subject=t,this.observer=e}return t.prototype.dispose=function(){var t=this.subject.observers.indexOf(this.observer);t>-1&&this.subject.observers.splice(t,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch(function(t){})},t}(),d=function(){function t(t){this.minimumLogLevel=t,this.outputConsole=console}return t.prototype.log=function(t,e){if(t>=this.minimumLogLevel)switch(t){case r.LogLevel.Critical:case r.LogLevel.Error:this.outputConsole.error("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e);break;case r.LogLevel.Warning:this.outputConsole.warn("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e);break;case r.LogLevel.Information:this.outputConsole.info("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e);break;default:this.outputConsole.log("["+(new Date).toISOString()+"] "+r.LogLevel[t]+": "+e)}},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"NullLogger",function(){return r});var r=function(){function t(){}return t.prototype.log=function(t,e){},t.instance=new t,t}()},function(t,e,n){"use strict";var r;n.r(e),n.d(e,"MessageType",function(){return r}),function(t){t[t.Invocation=1]="Invocation",t[t.StreamItem=2]="StreamItem",t[t.Completion=3]="Completion",t[t.StreamInvocation=4]="StreamInvocation",t[t.CancelInvocation=5]="CancelInvocation",t[t.Ping=6]="Ping",t[t.Close=7]="Close"}(r||(r={}))},function(t,e,n){"use strict";n.r(e),n.d(e,"Subject",function(){return o});var r=n(13),o=function(){function t(){this.observers=[]}return t.prototype.next=function(t){for(var e=0,n=this.observers;e<n.length;e++){n[e].next(t)}},t.prototype.error=function(t){for(var e=0,n=this.observers;e<n.length;e++){var r=n[e];r.error&&r.error(t)}},t.prototype.complete=function(){for(var t=0,e=this.observers;t<e.length;t++){var n=e[t];n.complete&&n.complete()}},t.prototype.subscribe=function(t){return this.observers.push(t),new r.SubjectSubscription(this,t)},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"HubConnectionBuilder",function(){return p});var r=n(18),o=n(19),i=n(10),s=n(9),c=n(25),a=n(14),u=n(13),l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},h={trace:s.LogLevel.Trace,debug:s.LogLevel.Debug,info:s.LogLevel.Information,information:s.LogLevel.Information,warn:s.LogLevel.Warning,warning:s.LogLevel.Warning,error:s.LogLevel.Error,critical:s.LogLevel.Critical,none:s.LogLevel.None};var p=function(){function t(){}return t.prototype.configureLogging=function(t){if(u.Arg.isRequired(t,"logging"),void 0!==t.log)this.logger=t;else if("string"==typeof t){var e=function(t){var e=h[t.toLowerCase()];if(void 0!==e)return e;throw new Error("Unknown log level: "+t)}(t);this.logger=new u.ConsoleLogger(e)}else this.logger=new u.ConsoleLogger(t);return this},t.prototype.withUrl=function(t,e){return u.Arg.isRequired(t,"url"),this.url=t,this.httpConnectionOptions=l({},this.httpConnectionOptions,"object"==typeof e?e:{transport:e}),this},t.prototype.withHubProtocol=function(t){return u.Arg.isRequired(t,"protocol"),this.protocol=t,this},t.prototype.withAutomaticReconnect=function(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return t?Array.isArray(t)?this.reconnectPolicy=new r.DefaultReconnectPolicy(t):this.reconnectPolicy=t:this.reconnectPolicy=new r.DefaultReconnectPolicy,this},t.prototype.build=function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new o.HttpConnection(this.url,t);return i.HubConnection.create(e,this.logger||a.NullLogger.instance,this.protocol||new c.JsonHubProtocol,this.reconnectPolicy)},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"DefaultReconnectPolicy",function(){return o});var r=[0,2e3,1e4,3e4,null],o=function(){function t(t){this.retryDelays=void 0!==t?t.concat([null]):r}return t.prototype.nextRetryDelayInMilliseconds=function(t){return this.retryDelays[t.previousRetryCount]},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"HttpConnection",function(){return d}),n.d(e,"TransportSendQueue",function(){return v});var r=n(6),o=n(9),i=n(20),s=n(21),c=n(23),a=n(13),u=n(24),l=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,c)}a((r=r.apply(t,e||[])).next())})},h=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},p=null,f=null;if(a.Platform.isNode){var g=require;p=g("ws"),f=g("eventsource")}var d=function(){function t(t,e){void 0===e&&(e={}),this.features={},this.negotiateVersion=1,a.Arg.isRequired(t,"url"),this.logger=Object(a.createLogger)(e.logger),this.baseUrl=this.resolveUrl(t),(e=e||{}).logMessageContent=e.logMessageContent||!1,a.Platform.isNode||"undefined"==typeof WebSocket||e.WebSocket?a.Platform.isNode&&!e.WebSocket&&p&&(e.WebSocket=p):e.WebSocket=WebSocket,a.Platform.isNode||"undefined"==typeof EventSource||e.EventSource?a.Platform.isNode&&!e.EventSource&&void 0!==f&&(e.EventSource=f):e.EventSource=EventSource,this.httpClient=e.httpClient||new r.DefaultHttpClient(this.logger),this.connectionState="Disconnected",this.connectionStarted=!1,this.options=e,this.onreceive=null,this.onclose=null}return t.prototype.start=function(t){return l(this,void 0,void 0,function(){var e;return h(this,function(n){switch(n.label){case 0:return t=t||i.TransferFormat.Binary,a.Arg.isIn(t,i.TransferFormat,"transferFormat"),this.logger.log(o.LogLevel.Debug,"Starting connection with transfer format '"+i.TransferFormat[t]+"'."),"Disconnected"!==this.connectionState?[2,Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."))]:(this.connectionState="Connecting ",this.startInternalPromise=this.startInternal(t),[4,this.startInternalPromise]);case 1:return n.sent(),"Disconnecting"!==this.connectionState?[3,3]:(e="Failed to start the HttpConnection before stop() was called.",this.logger.log(o.LogLevel.Error,e),[4,this.stopPromise]);case 2:return n.sent(),[2,Promise.reject(new Error(e))];case 3:if("Connected"!==this.connectionState)return e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!",this.logger.log(o.LogLevel.Error,e),[2,Promise.reject(new Error(e))];n.label=4;case 4:return this.connectionStarted=!0,[2]}})})},t.prototype.send=function(t){return"Connected"!==this.connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.sendQueue||(this.sendQueue=new v(this.transport)),this.sendQueue.send(t))},t.prototype.stop=function(t){return l(this,void 0,void 0,function(){var e=this;return h(this,function(n){switch(n.label){case 0:return"Disconnected"===this.connectionState?(this.logger.log(o.LogLevel.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnected state."),[2,Promise.resolve()]):"Disconnecting"===this.connectionState?(this.logger.log(o.LogLevel.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnecting state."),[2,this.stopPromise]):(this.connectionState="Disconnecting",this.stopPromise=new Promise(function(t){e.stopPromiseResolver=t}),[4,this.stopInternal(t)]);case 1:return n.sent(),[4,this.stopPromise];case 2:return n.sent(),[2]}})})},t.prototype.stopInternal=function(t){return l(this,void 0,void 0,function(){var e,n;return h(this,function(r){switch(r.label){case 0:this.stopError=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.startInternalPromise];case 2:return r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:if(!this.sendQueue)return[3,9];r.label=5;case 5:return r.trys.push([5,7,,8]),[4,this.sendQueue.stop()];case 6:return r.sent(),[3,8];case 7:return e=r.sent(),this.logger.log(o.LogLevel.Error,"TransportSendQueue.stop() threw error '"+e+"'."),[3,8];case 8:this.sendQueue=void 0,r.label=9;case 9:if(!this.transport)return[3,14];r.label=10;case 10:return r.trys.push([10,12,,13]),[4,this.transport.stop()];case 11:return r.sent(),[3,13];case 12:return n=r.sent(),this.logger.log(o.LogLevel.Error,"HttpConnection.transport.stop() threw error '"+n+"'."),this.stopConnection(),[3,13];case 13:return this.transport=void 0,[3,15];case 14:this.logger.log(o.LogLevel.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed."),this.stopConnection(),r.label=15;case 15:return[2]}})})},t.prototype.startInternal=function(t){return l(this,void 0,void 0,function(){var e,n,r,c,a,u;return h(this,function(l){switch(l.label){case 0:e=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,l.label=1;case 1:return l.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==i.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(i.HttpTransportType.WebSockets),[4,this.startTransport(e,t)]):[3,5];case 2:return l.sent(),[3,4];case 3:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,r=0,c=function(){var t;return h(this,function(o){switch(o.label){case 0:return[4,a.getNegotiationResponse(e)];case 1:if(n=o.sent(),"Disconnecting"===a.connectionState||"Disconnected"===a.connectionState)throw new Error("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(e=n.url),n.accessToken&&(t=n.accessToken,a.accessTokenFactory=function(){return t}),r++,[2]}})},a=this,l.label=6;case 6:return[5,c()];case 7:l.sent(),l.label=8;case 8:if(n.url&&r<100)return[3,6];l.label=9;case 9:if(100===r&&n.url)throw new Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(e,this.options.transport,n,t)];case 10:l.sent(),l.label=11;case 11:return this.transport instanceof s.LongPollingTransport&&(this.features.inherentKeepAlive=!0),"Connecting "===this.connectionState&&(this.logger.log(o.LogLevel.Debug,"The HttpConnection connected successfully."),this.connectionState="Connected"),[3,13];case 12:return u=l.sent(),this.logger.log(o.LogLevel.Error,"Failed to start the connection: "+u),this.connectionState="Disconnected",this.transport=void 0,[2,Promise.reject(u)];case 13:return[2]}})})},t.prototype.getNegotiationResponse=function(t){return l(this,void 0,void 0,function(){var e,n,r,i,s,c,a;return h(this,function(u){switch(u.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=u.sent())&&((e={}).Authorization="Bearer "+r,n=e),u.label=2;case 2:i=this.resolveNegotiateUrl(t),this.logger.log(o.LogLevel.Debug,"Sending negotiation request: "+i+"."),u.label=3;case 3:return u.trys.push([3,5,,6]),[4,this.httpClient.post(i,{content:"",headers:n})];case 4:return 200!==(s=u.sent()).statusCode?[2,Promise.reject(new Error("Unexpected status code returned from negotiate "+s.statusCode))]:((!(c=JSON.parse(s.content)).negotiateVersion||c.negotiateVersion<1)&&(c.connectionToken=c.connectionId),[2,c]);case 5:return a=u.sent(),this.logger.log(o.LogLevel.Error,"Failed to complete negotiation with the server: "+a),[2,Promise.reject(a)];case 6:return[2]}})})},t.prototype.createConnectUrl=function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id="+e:t},t.prototype.createTransport=function(t,e,n,r){return l(this,void 0,void 0,function(){var i,s,c,a,u,l,p,f,g,d,v;return h(this,function(h){switch(h.label){case 0:return i=this.createConnectUrl(t,n.connectionToken),this.isITransport(e)?(this.logger.log(o.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,[4,this.startTransport(i,r)]):[3,2];case 1:return h.sent(),this.connectionId=n.connectionId,[2];case 2:s=[],c=n.availableTransports||[],a=n,u=0,l=c,h.label=3;case 3:return u<l.length?(p=l[u],(f=this.resolveTransportOrError(p,e,r))instanceof Error?(s.push(p.transport+" failed: "+f),[3,12]):[3,4]):[3,13];case 4:if(!this.isITransport(f))return[3,12];if(this.transport=f,a)return[3,9];h.label=5;case 5:return h.trys.push([5,7,,8]),[4,this.getNegotiationResponse(t)];case 6:return a=h.sent(),[3,8];case 7:return g=h.sent(),[2,Promise.reject(g)];case 8:i=this.createConnectUrl(t,a.connectionToken),h.label=9;case 9:return h.trys.push([9,11,,12]),[4,this.startTransport(i,r)];case 10:return h.sent(),this.connectionId=a.connectionId,[2];case 11:return d=h.sent(),this.logger.log(o.LogLevel.Error,"Failed to start the transport '"+p.transport+"': "+d),a=void 0,s.push(p.transport+" failed: "+d),"Connecting "!==this.connectionState?(v="Failed to select transport before stop() was called.",this.logger.log(o.LogLevel.Debug,v),[2,Promise.reject(new Error(v))]):[3,12];case 12:return u++,[3,3];case 13:return s.length>0?[2,Promise.reject(new Error("Unable to connect to the server with any of the available transports. "+s.join(" ")))]:[2,Promise.reject(new Error("None of the transports supported by the client are supported by the server."))]}})})},t.prototype.constructTransport=function(t){switch(t){case i.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new u.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case i.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new c.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case i.HttpTransportType.LongPolling:return new s.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+t+".")}},t.prototype.startTransport=function(t,e){var n=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=function(t){return n.stopConnection(t)},this.transport.connect(t,e)},t.prototype.resolveTransportOrError=function(t,e,n){var r=i.HttpTransportType[t.transport];if(null==r)return this.logger.log(o.LogLevel.Debug,"Skipping transport '"+t.transport+"' because it is not supported by this client."),new Error("Skipping transport '"+t.transport+"' because it is not supported by this client.");if(!function(t,e){return!t||0!=(e&t)}(e,r))return this.logger.log(o.LogLevel.Debug,"Skipping transport '"+i.HttpTransportType[r]+"' because it was disabled by the client."),new Error("'"+i.HttpTransportType[r]+"' is disabled by the client.");if(!(t.transferFormats.map(function(t){return i.TransferFormat[t]}).indexOf(n)>=0))return this.logger.log(o.LogLevel.Debug,"Skipping transport '"+i.HttpTransportType[r]+"' because it does not support the requested transfer format '"+i.TransferFormat[n]+"'."),new Error("'"+i.HttpTransportType[r]+"' does not support "+i.TransferFormat[n]+".");if(r===i.HttpTransportType.WebSockets&&!this.options.WebSocket||r===i.HttpTransportType.ServerSentEvents&&!this.options.EventSource)return this.logger.log(o.LogLevel.Debug,"Skipping transport '"+i.HttpTransportType[r]+"' because it is not supported in your environment.'"),new Error("'"+i.HttpTransportType[r]+"' is not supported in your environment.");this.logger.log(o.LogLevel.Debug,"Selecting transport '"+i.HttpTransportType[r]+"'.");try{return this.constructTransport(r)}catch(t){return t}},t.prototype.isITransport=function(t){return t&&"object"==typeof t&&"connect"in t},t.prototype.stopConnection=function(t){if(this.logger.log(o.LogLevel.Debug,"HttpConnection.stopConnection("+t+") called while in state "+this.connectionState+"."),this.transport=void 0,t=this.stopError||t,this.stopError=void 0,"Disconnected"!==this.connectionState)if("Connecting "!==this.connectionState){if("Disconnecting"===this.connectionState&&this.stopPromiseResolver(),t?this.logger.log(o.LogLevel.Error,"Connection disconnected with error '"+t+"'."):this.logger.log(o.LogLevel.Information,"Connection disconnected."),this.connectionId=void 0,this.connectionState="Disconnected",this.onclose&&this.connectionStarted){this.connectionStarted=!1;try{this.onclose(t)}catch(e){this.logger.log(o.LogLevel.Error,"HttpConnection.onclose("+t+") threw error '"+e+"'.")}}}else this.logger.log(o.LogLevel.Warning,"Call to HttpConnection.stopConnection("+t+") was ignored because the connection hasn't yet left the in the connecting state.");else this.logger.log(o.LogLevel.Debug,"Call to HttpConnection.stopConnection("+t+") was ignored because the connection is already in the disconnected state.")},t.prototype.resolveUrl=function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if(!a.Platform.isBrowser||!window.document)throw new Error("Cannot resolve '"+t+"'.");var e=window.document.createElement("a");return e.href=t,this.logger.log(o.LogLevel.Information,"Normalizing '"+t+"' to '"+e.href+"'."),e.href},t.prototype.resolveNegotiateUrl=function(t){var e=t.indexOf("?"),n=t.substring(0,-1===e?t.length:e);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",-1===(n+=-1===e?"":t.substring(e)).indexOf("negotiateVersion")&&(n+=-1===e?"?":"&",n+="negotiateVersion="+this.negotiateVersion),n},t}();var v=function(){function t(t){this.transport=t,this.buffer=[],this.executing=!0,this.sendBufferedData=new y,this.transportResult=new y,this.sendLoopPromise=this.sendLoop()}return t.prototype.send=function(t){return this.bufferData(t),this.transportResult||(this.transportResult=new y),this.transportResult.promise},t.prototype.stop=function(){return this.executing=!1,this.sendBufferedData.resolve(),this.sendLoopPromise},t.prototype.bufferData=function(t){if(this.buffer.length&&typeof this.buffer[0]!=typeof t)throw new Error("Expected data to be of type "+typeof this.buffer+" but was of type "+typeof t);this.buffer.push(t),this.sendBufferedData.resolve()},t.prototype.sendLoop=function(){return l(this,void 0,void 0,function(){var e,n,r;return h(this,function(o){switch(o.label){case 0:return[4,this.sendBufferedData.promise];case 1:if(o.sent(),!this.executing)return this.transportResult&&this.transportResult.reject("Connection stopped."),[3,6];this.sendBufferedData=new y,e=this.transportResult,this.transportResult=void 0,n="string"==typeof this.buffer[0]?this.buffer.join(""):t.concatBuffers(this.buffer),this.buffer.length=0,o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.transport.send(n)];case 3:return o.sent(),e.resolve(),[3,5];case 4:return r=o.sent(),e.reject(r),[3,5];case 5:return[3,0];case 6:return[2]}})})},t.concatBuffers=function(t){for(var e=t.map(function(t){return t.byteLength}).reduce(function(t,e){return t+e}),n=new Uint8Array(e),r=0,o=0,i=t;o<i.length;o++){var s=i[o];n.set(new Uint8Array(s),r),r+=s.byteLength}return n},t}(),y=function(){function t(){var t=this;this.promise=new Promise(function(e,n){var r;return r=[e,n],t.resolver=r[0],t.rejecter=r[1],r})}return t.prototype.resolve=function(){this.resolver()},t.prototype.reject=function(t){this.rejecter(t)},t}()},function(t,e,n){"use strict";var r,o;n.r(e),n.d(e,"HttpTransportType",function(){return r}),n.d(e,"TransferFormat",function(){return o}),function(t){t[t.None=0]="None",t[t.WebSockets=1]="WebSockets",t[t.ServerSentEvents=2]="ServerSentEvents",t[t.LongPolling=4]="LongPolling"}(r||(r={})),function(t){t[t.Text=1]="Text",t[t.Binary=2]="Binary"}(o||(o={}))},function(t,e,n){"use strict";n.r(e),n.d(e,"LongPollingTransport",function(){return l});var r=n(22),o=n(4),i=n(9),s=n(20),c=n(13),a=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,c)}a((r=r.apply(t,e||[])).next())})},u=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},l=function(){function t(t,e,n,o){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.pollAbort=new r.AbortController,this.logMessageContent=o,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(t.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),t.prototype.connect=function(t,e){return a(this,void 0,void 0,function(){var n,r,a,l;return u(this,function(u){switch(u.label){case 0:if(c.Arg.isRequired(t,"url"),c.Arg.isRequired(e,"transferFormat"),c.Arg.isIn(e,s.TransferFormat,"transferFormat"),this.url=t,this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Connecting."),e===s.TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},e===s.TransferFormat.Binary&&(n.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return r=u.sent(),this.updateHeaderToken(n,r),a=t+"&_="+Date.now(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) polling: "+a+"."),[4,this.httpClient.get(a,n)];case 2:return 200!==(l=u.sent()).statusCode?(this.logger.log(i.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+l.statusCode+"."),this.closeError=new o.HttpError(l.statusText||"",l.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,n),[2]}})})},t.prototype.getAccessToken=function(){return a(this,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,null]}})})},t.prototype.updateHeaderToken=function(t,e){t.headers||(t.headers={}),e?t.headers.Authorization="Bearer "+e:t.headers.Authorization&&delete t.headers.Authorization},t.prototype.poll=function(t,e){return a(this,void 0,void 0,function(){var n,r,s,a;return u(this,function(u){switch(u.label){case 0:u.trys.push([0,,8,9]),u.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=u.sent(),this.updateHeaderToken(e,n),u.label=3;case 3:return u.trys.push([3,5,,6]),r=t+"&_="+Date.now(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,e)];case 4:return 204===(s=u.sent()).statusCode?(this.logger.log(i.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==s.statusCode?(this.logger.log(i.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+s.statusCode+"."),this.closeError=new o.HttpError(s.statusText||"",s.statusCode),this.running=!1):s.content?(this.logger.log(i.LogLevel.Trace,"(LongPolling transport) data received. "+Object(c.getDataDetail)(s.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(s.content)):this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return a=u.sent(),this.running?a instanceof o.TimeoutError?this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=a,this.running=!1):this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+a.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},t.prototype.send=function(t){return a(this,void 0,void 0,function(){return u(this,function(e){return this.running?[2,Object(c.sendMessage)(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},t.prototype.stop=function(){return a(this,void 0,void 0,function(){var t,e;return u(this,function(n){switch(n.label){case 0:this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),n.label=1;case 1:return n.trys.push([1,,5,6]),[4,this.receiving];case 2:return n.sent(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),t={headers:{}},[4,this.getAccessToken()];case 3:return e=n.sent(),this.updateHeaderToken(t,e),[4,this.httpClient.delete(this.url,t)];case 4:return n.sent(),this.logger.log(i.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(i.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},t.prototype.raiseOnClose=function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this.closeError&&(t+=" Error: "+this.closeError),this.logger.log(i.LogLevel.Trace,t),this.onclose(this.closeError)}},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"AbortController",function(){return r});var r=function(){function t(){this.isAborted=!1,this.onabort=null}return t.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(t.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"ServerSentEventsTransport",function(){return a});var r=n(9),o=n(20),i=n(13),s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,c)}a((r=r.apply(t,e||[])).next())})},c=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},a=function(){function t(t,e,n,r,o){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.logMessageContent=r,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(t,e){return s(this,void 0,void 0,function(){var n,s=this;return c(this,function(c){switch(c.label){case 0:return i.Arg.isRequired(t,"url"),i.Arg.isRequired(e,"transferFormat"),i.Arg.isIn(e,o.TransferFormat,"transferFormat"),this.logger.log(r.LogLevel.Trace,"(SSE transport) Connecting."),this.url=t,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=c.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),c.label=2;case 2:return[2,new Promise(function(n,c){var a=!1;if(e===o.TransferFormat.Text){var u;if(i.Platform.isBrowser||i.Platform.isWebWorker)u=new s.eventSourceConstructor(t,{withCredentials:!0});else{var l=s.httpClient.getCookieString(t);u=new s.eventSourceConstructor(t,{withCredentials:!0,headers:{Cookie:l}})}try{u.onmessage=function(t){if(s.onreceive)try{s.logger.log(r.LogLevel.Trace,"(SSE transport) data received. "+Object(i.getDataDetail)(t.data,s.logMessageContent)+"."),s.onreceive(t.data)}catch(t){return void s.close(t)}},u.onerror=function(t){var e=new Error(t.data||"Error occurred");a?s.close(e):c(e)},u.onopen=function(){s.logger.log(r.LogLevel.Information,"SSE connected to "+s.url),s.eventSource=u,a=!0,n()}}catch(t){return void c(t)}}else c(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},t.prototype.send=function(t){return s(this,void 0,void 0,function(){return c(this,function(e){return this.eventSource?[2,Object(i.sendMessage)(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},t.prototype.stop=function(){return this.close(),Promise.resolve()},t.prototype.close=function(t){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(t))},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"WebSocketTransport",function(){return a});var r=n(9),o=n(20),i=n(13),s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,c)}a((r=r.apply(t,e||[])).next())})},c=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},a=function(){function t(t,e,n,r,o){this.logger=n,this.accessTokenFactory=e,this.logMessageContent=r,this.webSocketConstructor=o,this.httpClient=t,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(t,e){return s(this,void 0,void 0,function(){var n,s=this;return c(this,function(c){switch(c.label){case 0:return i.Arg.isRequired(t,"url"),i.Arg.isRequired(e,"transferFormat"),i.Arg.isIn(e,o.TransferFormat,"transferFormat"),this.logger.log(r.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=c.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),c.label=2;case 2:return[2,new Promise(function(n,c){var a;t=t.replace(/^http/,"ws");var u=s.httpClient.getCookieString(t),l=!1;i.Platform.isNode&&u&&(a=new s.webSocketConstructor(t,void 0,{headers:{Cookie:""+u}})),a||(a=new s.webSocketConstructor(t)),e===o.TransferFormat.Binary&&(a.binaryType="arraybuffer"),a.onopen=function(e){s.logger.log(r.LogLevel.Information,"WebSocket connected to "+t+"."),s.webSocket=a,l=!0,n()},a.onerror=function(t){var e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:new Error("There was an error with the transport."),c(e)},a.onmessage=function(t){s.logger.log(r.LogLevel.Trace,"(WebSockets transport) data received. "+Object(i.getDataDetail)(t.data,s.logMessageContent)+"."),s.onreceive&&s.onreceive(t.data)},a.onclose=function(t){if(l)s.close(t);else{var e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:new Error("There was an error with the transport."),c(e)}}})]}})})},t.prototype.send=function(t){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(r.LogLevel.Trace,"(WebSockets transport) sending data. "+Object(i.getDataDetail)(t,this.logMessageContent)+"."),this.webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},t.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},t.prototype.close=function(t){this.logger.log(r.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!t||!1!==t.wasClean&&1e3===t.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+t.code+" ("+t.reason+").")))},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"JsonHubProtocol",function(){return u});var r=n(15),o=n(9),i=n(20),s=n(14),c=n(12),a="json",u=function(){function t(){this.name=a,this.version=1,this.transferFormat=i.TransferFormat.Text}return t.prototype.parseMessages=function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=s.NullLogger.instance);for(var n=[],i=0,a=c.TextMessageFormat.parse(t);i<a.length;i++){var u=a[i],l=JSON.parse(u);if("number"!=typeof l.type)throw new Error("Invalid payload.");switch(l.type){case r.MessageType.Invocation:this.isInvocationMessage(l);break;case r.MessageType.StreamItem:this.isStreamItemMessage(l);break;case r.MessageType.Completion:this.isCompletionMessage(l);break;case r.MessageType.Ping:case r.MessageType.Close:break;default:e.log(o.LogLevel.Information,"Unknown message type '"+l.type+"' ignored.");continue}n.push(l)}return n},t.prototype.writeMessage=function(t){return c.TextMessageFormat.write(JSON.stringify(t))},t.prototype.isInvocationMessage=function(t){this.assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")},t.prototype.isStreamItemMessage=function(t){if(this.assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")},t.prototype.isCompletionMessage=function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.assertNotEmptyString(t.error,"Invalid payload for Completion message."),this.assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")},t.prototype.assertNotEmptyString=function(t,e){if("string"!=typeof t||""===t)throw new Error(e)},t}()}])});
var abp=abp||{};!function(){function n(n){abp.signalr.hubs.common=n;let e=1,a=abp.signalr.reconnectTime;n.onclose(function(t){t?abp.log.debug("Connection closed with error: "+t):abp.log.debug("Disconnected"),abp.signalr.autoReconnect&&function t(){e>abp.signalr.maxTries||n.start().then(()=>{a=abp.signalr.reconnectTime,e=1,console.log("Reconnected to SignalR server!")}).catch(()=>{e+=1,a=abp.signalr.increaseReconnectTime(a),setTimeout(()=>t(),a)})}()}),n.on("getNotification",function(n){abp.event.trigger("abp.notifications.received",n)})}function e(n,e){return abp.signalr.remoteServiceBaseUrl&&(n=abp.signalr.remoteServiceBaseUrl+n),abp.signalr.qs&&(n+=(-1==n.indexOf("?")?"?":"&")+abp.signalr.qs),function a(t){abp.log.debug("Starting connection using "+signalR.HttpTransportType[t]+" transport");var i=(new signalR.HubConnectionBuilder).withUrl(n,t).build();return e&&"function"==typeof e&&e(i),i.start().then(function(){return i}).catch(function(n){return abp.log.debug("Cannot start the connection using "+signalR.HttpTransportType[t]+" transport. "+n.message),t!==signalR.HttpTransportType.LongPolling?a(t+1):Promise.reject(n)})}(signalR.HttpTransportType.WebSockets)}signalR&&(abp.signalr=abp.signalr||{},abp.signalr.hubs=abp.signalr.hubs||{},abp.signalr.reconnectTime=abp.signalr.reconnectTime||5e3,abp.signalr.maxTries=abp.signalr.maxTries||8,abp.signalr.increaseReconnectTime=abp.signalr.increaseReconnectTime||function(n){return 2*n},abp.signalr.autoConnect=void 0===abp.signalr.autoConnect||abp.signalr.autoConnect,abp.signalr.autoReconnect=void 0===abp.signalr.autoReconnect||abp.signalr.autoReconnect,abp.signalr.connect=abp.signalr.connect||function(){e(abp.signalr.url||abp.appPath+"signalr",n).then(function(n){abp.log.debug("Connected to SignalR server!"),abp.event.trigger("abp.signalr.connected"),n.invoke("register").then(function(){abp.log.debug("Registered to the SignalR server!")})}).catch(function(n){abp.log.debug(n.message)})},abp.signalr.startConnection=abp.signalr.startConnection||e,abp.signalr.autoConnect&&!abp.signalr.hubs.common&&abp.signalr.connect())}();