!function(e){e(function(){var t=abp.services.app.hostSettings,i=e("#GeneralSettingsForm [name=Timezone]").val(),n=e("#GeneralSettingsForm [name=TimezoneForComparison]").val()===abp.setting.values["Abp.Timing.TimeZone"],a=new KeyValueListManager,s=new KeyValueListManager,o=e("#SettingsTabPanel"),l=e("#EmailSmtpSettingsForm").serializeFormToObject(),r=o.find("input[name=SmtpDomain],input[name=SmtpUserName],input[name=SmtpPassword]").closest(".form-group"),m=o.find("input[name=IsNewRegisteredTenantActiveByDefault],input[name=UseCaptchaOnRegistration]").closest(".form-group"),c=e("#UserLockOutSettingsForm").find("input").not("#Setting_UserLockOut_IsEnabled").closest(".form-group"),d=e("#TwoFactorLoginSettingsForm").find("input").not("#Setting_TwoFactorLogin_IsEnabled").closest(".checkbox"),g=o.find(".divSessionTimeOut");function S(){e("#Settings_SmtpUseDefaultCredentials").is(":checked")?r.slideUp("fast"):r.slideDown("fast")}function p(){e("#Setting_AllowSelfRegistration").is(":checked")?m.slideDown("fast"):m.slideUp("fast")}function u(){e("#Setting_UserLockOut_IsEnabled").is(":checked")?c.slideDown("fast"):c.slideUp("fast")}function f(){e("#Setting_TwoFactorLogin_IsEnabled").is(":checked")?d.slideDown("fast"):d.slideUp("fast")}function _(){e("#Setting_IsSessionTimeOutEnabled").is(":checked")?g.slideDown("fast"):g.slideUp("fast")}function F(){var t=e("#DefaultPasswordComplexitySettingsForm input:disabled");t.removeAttr("disabled");var i=e("#DefaultPasswordComplexitySettingsForm").serializeFormToObject();return t.attr("disabled","disabled"),i}S(),p(),u(),f(),_(),e("#Settings_SmtpUseDefaultCredentials").change(function(){S()}),e("#Setting_AllowSelfRegistration").change(function(){p()}),e("#Setting_UserLockOut_IsEnabled").change(function(){u()}),e("#Setting_TwoFactorLogin_IsEnabled").change(function(){f()}),e("#Setting_IsSessionTimeOutEnabled").change(function(){_()}),e("#Setting_PasswordComplexity_UseDefaultSettings").change(function(t){e("#Setting_PasswordComplexity_UseDefaultSettings").is(":checked")?e("#PasswordComplexitySettingsForm").hide("fast",function(){e("#DefaultPasswordComplexitySettingsForm").show("fast")}):e("#DefaultPasswordComplexitySettingsForm").hide("fast",function(){e("#PasswordComplexitySettingsForm").show("fast")})}),e("#SaveAllSettingsButton").click(function(){if(e("#EmailSmtpSettingsForm").valid()){var o=e("#UserManagementSettingsForm").serializeFormToObject();o.sessionTimeOutSettings={isEnabled:e("#Setting_IsSessionTimeOutEnabled").is(":checked"),timeOutSecond:e("#Setting_SessionTimeOutSecond").val(),showTimeOutNotificationSecond:e("#Setting_ShowTimeOutNotificationSecond").val(),showLockScreenWhenTimedOut:e("#Setting_ShowLockScreenWhenTimedOut").is(":checked")},t.updateAllSettings({general:e("#GeneralSettingsForm").serializeFormToObject(),tenantManagement:e("#TenantManagementSettingsForm").serializeFormToObject(),userManagement:o,email:e("#EmailSmtpSettingsForm").serializeFormToObject(),chat:e("#ChatSettingsForm").serializeFormToObject(),billing:e("#BillingSettingsForm").serializeFormToObject(),otherSettings:e("#OtherSettingsForm").serializeFormToObject(),security:{useDefaultPasswordComplexitySettings:e("#Setting_PasswordComplexity_UseDefaultSettings").is(":checked"),passwordComplexity:e("#PasswordComplexitySettingsForm").serializeFormToObject(),defaultPasswordComplexity:F(),userLockOut:e("#UserLockOutSettingsForm").serializeFormToObject(),twoFactorLogin:e("#TwoFactorLoginSettingsForm").serializeFormToObject(),AllowOneConcurrentLoginPerUser:e("#Setting_AllowOneConcurrentLoginPerUser").is(":checked")},externalLoginProviderSettings:{facebook:{appId:e("#Setting_Facebook_AppId").val(),appSecret:e("#Setting_Facebook_AppSecret").val()},google:{clientId:e("#Setting_Google_ClientId").val(),clientSecret:e("#Setting_Google_ClientSecret").val(),userInfoEndpoint:e("#Setting_Google_UserInfoEndpoint").val()},twitter:{consumerKey:e("#Setting_Twitter_ConsumerKey").val(),consumerSecret:e("#Setting_Twitter_ConsumerSecret").val()},microsoft:{clientId:e("#Setting_Microsoft_ClientId").val(),clientSecret:e("#Setting_Microsoft_ClientSecret").val()},openIdConnect:{clientId:e("#Setting_OpenIdConnect_ClientId").val(),clientSecret:e("#Setting_OpenIdConnect_ClientSecret").val(),authority:e("#Setting_OpenIdConnect_Authority").val(),validateIssuer:e("#Setting_OpenIdConnect_ValidateIssuer").prop("checked")},openIdConnectClaimsMapping:a.getValues().map(e=>({key:e.key,claim:e.value})),wsFederation:{clientId:e("#Setting_WsFederation_ClientId").val(),tenant:e("#Setting_WsFederation_Tenant").val(),metaDataAddress:e("#Setting_WsFederation_MetaDataAddress").val(),wtrealm:e("#Setting_WsFederation_Wtrealm").val(),authority:e("#Setting_WsFederation_Authority").val()},wsFederationClaimsMapping:s.getValues().map(e=>({key:e.key,claim:e.value}))}}).done(function(){abp.notify.info(app.localize("SavedSuccessfully"));var t=e("#GeneralSettingsForm [name=Timezone]").val();abp.clock.provider.supportsMultipleTimezone&&n&&i!==t&&abp.message.info(app.localize("TimeZoneSettingChangedRefreshPageNotification")).done(function(){window.location.reload()}),l=e("#EmailSmtpSettingsForm").serializeFormToObject()})}}),e("#SendTestEmailButton").click(function(){if(e("#EmailSmtpSettingsTestForm").valid()){var i=e("#EmailSmtpSettingsForm").serializeFormToObject();JSON.stringify(l)!==JSON.stringify(i)?abp.message.confirm(app.localize("SendEmailWithSavedSettingsWarning"),app.localize("AreYouSure"),function(i){i&&t.sendTestEmail({emailAddress:e("#TestEmailAddressInput").val()}).done(function(){abp.notify.info(app.localize("TestEmailSentSuccessfully"))})}):t.sendTestEmail({emailAddress:e("#TestEmailAddressInput").val()}).done(function(){abp.notify.info(app.localize("TestEmailSentSuccessfully"))})}}),e(".passwordShowButton").click(function(){var t=e(this).data("id"),i=e("#"+t);i&&("password"===i[0].type?(i[0].type="text",e(this).find("i").removeClass("fa-eye"),e(this).find("i").addClass("fa-eye-slash"),e(this).find("span").text(app.localize("Hide"))):(i[0].type="password",e(this).find("i").removeClass("fa-eye-slash"),e(this).find("i").addClass("fa-eye"),e(this).find("span").text(app.localize("Show"))))}),a.init({containerId:"claimsMappingsContainer",name:"openIdConnectClaimsMappings",keyName:"ClaimKey",valueName:"ClaimValue",items:openIdConnectClaimsMappings.map(e=>({key:e.Key,value:e.Claim}))}),s.init({containerId:"Setting_WsFederation_ClaimsMappingsContainer",name:"wsFederationClaimsMappings",keyName:"ClaimKey",valueName:"ClaimValue",items:wsFederationClaimsMappings.map(e=>({key:e.Key,value:e.Claim}))}),e("#EmailSmtpSettingsForm").validate(),e("#EmailSmtpSettingsTestForm").validate()})}(jQuery);